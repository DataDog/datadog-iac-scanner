{
  "id": "65d07da5-9af5-44df-8983-52d2e6f24c44",
  "queryName": "CloudTrail not integrated with CloudWatch",
  "severity": "LOW",
  "category": "Observability",
  "descriptionText": "CloudTrail should be configured to deliver events to CloudWatch Logs so you have real-time monitoring, alerting, and a reliable audit trail for investigation and incident response. For `AWS::CloudTrail::Trail` resources, the `Properties` must include `CloudWatchLogsLogGroupArn` (the CloudWatch Log Group ARN) and `CloudWatchLogsRoleArn` (an IAM role ARN that CloudTrail can assume). Resources missing either property will be flagged. Ensure the referenced IAM role allows the CloudTrail service principal to write to CloudWatch Logs (for example, `logs:CreateLogStream` and `logs:PutLogEvents`).\n\nSecure CloudFormation example:\n\n```yaml\nMyLogGroup:\n  Type: AWS::Logs::LogGroup\n  Properties:\n    LogGroupName: /aws/cloudtrail/my-trail\n\nMyTrailRole:\n  Type: AWS::IAM::Role\n  Properties:\n    AssumeRolePolicyDocument:\n      Statement:\n        - Effect: Allow\n          Principal:\n            Service: cloudtrail.amazonaws.com\n          Action: sts:AssumeRole\n    Policies:\n      - PolicyName: CloudTrailPutLogs\n        PolicyDocument:\n          Statement:\n            - Effect: Allow\n              Action:\n                - logs:CreateLogStream\n                - logs:PutLogEvents\n              Resource: !GetAtt MyLogGroup.Arn\n\nMyTrail:\n  Type: AWS::CloudTrail::Trail\n  Properties:\n    IsLogging: true\n    CloudWatchLogsLogGroupArn: !GetAtt MyLogGroup.Arn\n    CloudWatchLogsRoleArn: !GetAtt MyTrailRole.Arn\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/cloudtrail_not_integrated_with_cloudwatch",
  "platform": "CloudFormation",
  "descriptionID": "f43ba695",
  "cloudProvider": "aws",
  "cwe": "778",
  "oldSeverity": "MEDIUM",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudtrail-trail.html"
}