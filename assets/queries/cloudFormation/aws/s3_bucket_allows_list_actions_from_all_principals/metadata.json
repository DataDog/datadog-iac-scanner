{
  "id": "faa8fddf-c0aa-4b2d-84ff-e993e233ebe9",
  "queryName": "S3 bucket allows list action from all principals",
  "severity": "HIGH",
  "category": "Access Control",
  "descriptionText": "Bucket policies that grant list actions to all principals (`*`) allow anyone to enumerate a bucketâ€™s contents and metadata. This can expose sensitive filenames and enable targeted data discovery or exfiltration. For CloudFormation, inspect `AWS::S3::BucketPolicy` resources' `Properties.PolicyDocument.Statement` entries. Ensure no statement has `Effect: \"Allow\"` with `Principal: \"*\"` (or including `*`) while `Action` includes list operations such as `s3:ListBucket`. Resources missing the policy document, or containing statements that allow list actions to wildcard principals, will be flagged. Restrict listing permissions to specific AWS account IDs, IAM roles, or ARNs, or remove list permissions for public principals.\n\nSecure example restricting list actions to a specific principal:\n\n```yaml\nMyBucketPolicy:\n  Type: AWS::S3::BucketPolicy\n  Properties:\n    Bucket: !Ref MyBucket\n    PolicyDocument:\n      Statement:\n        - Effect: Allow\n          Principal:\n            AWS: arn:aws:iam::123456789012:role/AllowedRole\n          Action: s3:ListBucket\n          Resource: !Sub arn:aws:s3:::${MyBucket}\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/s3_bucket_allows_list_actions_from_all_principals",
  "platform": "CloudFormation",
  "descriptionID": "755801fc",
  "cloudProvider": "aws",
  "cwe": "200",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html"
}
