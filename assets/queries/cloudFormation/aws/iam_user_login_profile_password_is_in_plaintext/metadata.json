{
  "id": "06adef8c-c284-4de7-aad2-af43b07a8ca1",
  "queryName": "IAM user LoginProfile password is in plaintext",
  "severity": "HIGH",
  "category": "Secret Management",
  "descriptionText": "Defining an IAM user's console password as a plaintext string in an AWS CloudFormation template embeds credentials in source control and template history, increasing the risk of credential leakage and unauthorized account access. For `AWS::IAM::User` resources, `Properties.LoginProfile.Password` must not be a string literal. Resources where `Properties.LoginProfile.Password` is a literal string will be flagged. Use an AWS Secrets Manager dynamic reference to supply the password so it is not stored directly in the template.\n\nSecure configuration example using a Secrets Manager dynamic reference:\n\n```yaml\nMyUser:\n  Type: AWS::IAM::User\n  Properties:\n    UserName: example-user\n    LoginProfile:\n      Password: \"{{resolve:secretsmanager:my-app/iam/user-password:SecretString:password}}\"\n      PasswordResetRequired: true\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/iam_user_login_profile_password_is_in_plaintext",
  "platform": "CloudFormation",
  "descriptionID": "0dc817e6",
  "cloudProvider": "aws",
  "cwe": "256",
  "oldSeverity": "MEDIUM",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-user.html"
}