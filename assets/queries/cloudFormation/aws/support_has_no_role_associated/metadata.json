{
  "id": "d71b5fd7-9020-4b2d-9ec8-b3839faa2744",
  "queryName": "Support has no role associated",
  "severity": "LOW",
  "category": "Access Control",
  "descriptionText": "IAM policies named `AWSSupportAccess` should be attached to explicit principals so support permissions are intentionally granted and controlled. An `AWS::IAM::Policy` with `PolicyName: \"AWSSupportAccess\"` that has no `Roles`, `Users`, or `Groups` defined is unmanaged or orphaned, which can lead to configuration drift or accidental future attachment that grants broad support privileges.\n\nCheck `AWS::IAM::Policy` resources where `PolicyName` equals `AWSSupportAccess` and ensure at least one of the `Roles`, `Users`, or `Groups` properties is present and contains one or more principals. Resources with these properties missing or empty will be flagged. Attach the policy to designated principals (for example, a support role) to make intent explicit and maintain least privilege.\n\nSecure configuration example with a role attachment:\n\n```yaml\nMySupportPolicy:\n  Type: AWS::IAM::Policy\n  Properties:\n    PolicyName: AWSSupportAccess\n    PolicyDocument:\n      Version: \"2012-10-17\"\n      Statement:\n        - Effect: Allow\n          Action: \"support:*\"\n          Resource: \"*\"\n    Roles:\n      - !Ref SupportRole\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/support_has_no_role_associated",
  "platform": "CloudFormation",
  "descriptionID": "42d28f69",
  "cloudProvider": "aws",
  "cwe": "284",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-iam-policy.html"
}