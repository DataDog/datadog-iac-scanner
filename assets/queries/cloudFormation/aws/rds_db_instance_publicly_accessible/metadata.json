{
  "id": "de38e1d5-54cb-4111-a868-6f7722695007",
  "queryName": "RDS DB instance publicly accessible",
  "severity": "CRITICAL",
  "category": "Insecure Configurations",
  "descriptionText": "RDS DB instances must not be publicly accessible because exposing a database endpoint to the internet increases the attack surface and can enable unauthorized access, credential-guessing attacks, and data exfiltration. In AWS CloudFormation, the `PubliclyAccessible` property on `AWS::RDS::DBInstance` resources must be set to `false`. Resources with `PubliclyAccessible` set to `true` will be flagged. If the property is omitted, ensure the instance is deployed to private subnets and protected by restrictive security groups so it cannot receive a public IP or accept traffic from the internet.\n\nSecure configuration example:\n\n```yaml\nMyDBInstance:\n  Type: AWS::RDS::DBInstance\n  Properties:\n    DBInstanceIdentifier: my-db-instance\n    Engine: postgres\n    EngineVersion: '14.7'\n    DBInstanceClass: db.t3.micro\n    AllocatedStorage: 20\n    MasterUsername: admin\n    MasterUserPassword: !Ref DBPassword\n    PubliclyAccessible: false\n    DBSubnetGroupName: !Ref MyDBSubnetGroup\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/rds_db_instance_publicly_accessible",
  "platform": "CloudFormation",
  "descriptionID": "dae1e8ab",
  "cloudProvider": "aws",
  "cwe": "668",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html"
}
