{
  "id": "dc17ee4b-ddf2-4e23-96e8-7a36abad1303",
  "queryName": "CloudFront without minimum protocol TLS 1.2",
  "severity": "MEDIUM",
  "category": "Insecure Configurations",
  "descriptionText": "CloudFront distributions must define a `ViewerCertificate` and enforce a minimum TLS version of 1.2 to prevent the use of weak SSL/TLS protocols that can enable downgrade attacks and interception of client connections.\n\n For `AWS::CloudFront::Distribution` resources, ensure `Properties.DistributionConfig.ViewerCertificate` is present and its `MinimumProtocolVersion` is set to a TLS 1.2 family value (for example, `TLSv1.2_2018` or `TLSv1.2_2019`). Also include an appropriate certificate reference (such as `ACMCertificateArn`) and `SslSupportMethod`.\n\n This check only applies to distributions that are enabled (`DistributionConfig.Enabled` not set to `false`). Resources missing `ViewerCertificate` or with `MinimumProtocolVersion` lower than TLS 1.2 will be flagged.\n\nSecure CloudFormation example:\n\n```yaml\nMyDistribution:\n  Type: AWS::CloudFront::Distribution\n  Properties:\n    DistributionConfig:\n      Enabled: true\n      ViewerCertificate:\n        ACMCertificateArn: arn:aws:acm:us-east-1:123456789012:certificate/abcdef01-2345-6789-abcd-ef0123456789\n        SslSupportMethod: sni-only\n        MinimumProtocolVersion: TLSv1.2_2019\n      Origins:\n        - Id: myOrigin\n          DomainName: example.com\n          CustomOriginConfig:\n            HTTPPort: 80\n            HTTPSPort: 443\n            OriginProtocolPolicy: https-only\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/cloudfront_without_minimum_protocol_tls_1.2",
  "platform": "CloudFormation",
  "descriptionID": "e86728bc",
  "cloudProvider": "aws",
  "cwe": "311",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-cloudfront-distribution.html"
}