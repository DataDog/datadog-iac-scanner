{
  "id": "c3ce69fd-e3df-49c6-be78-1db3f802261c",
  "queryName": "S3 bucket CloudTrail logging disabled",
  "severity": "MEDIUM",
  "category": "Observability",
  "descriptionText": "S3 buckets that receive CloudTrail log deliveries should have S3 server access logging enabled so access to log files and object-level operations are recorded for auditing and incident investigation. Without access logs, unauthorized reads, writes, or deletions of delivered logs may go undetected.\n\nThis rule looks for `AWS::S3::Bucket` resources referenced by an `AWS::S3::BucketPolicy` where `PolicyDocument.Statement[].Principal.Service == \"cloudtrail.amazonaws.com\"`. For those buckets, `Properties.LoggingConfiguration` must be defined. Resources missing `LoggingConfiguration` will be flagged. Set `LoggingConfiguration.DestinationBucketName` (and optionally `LogFilePrefix`) to a dedicated logging bucket to collect access logs.\n\nSecure CloudFormation example:\n\n```yaml\nMyCloudTrailBucket:\n  Type: AWS::S3::Bucket\n  Properties:\n    BucketName: my-cloudtrail-bucket\n    LoggingConfiguration:\n      DestinationBucketName: my-logging-bucket\n      LogFilePrefix: access-logs/\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/s3_bucket_cloudtrail_logging_disabled",
  "platform": "CloudFormation",
  "descriptionID": "00649261",
  "cloudProvider": "aws",
  "cwe": "778",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html#cfn-s3-bucket-loggingconfig"
}