{
  "id": "9b83114b-b2a1-4534-990d-06da015e47aa",
  "queryName": "Lambda permission misconfigured",
  "severity": "LOW",
  "category": "Best Practices",
  "descriptionText": "Lambda permissions must explicitly allow only the invocation action to enforce least privilege and prevent unintended access to other function operations or configuration. In AWS CloudFormation, the `Action` property in `AWS::Lambda::Permission` resources must be set exactly to `lambda:InvokeFunction`. Resources missing `Action` or with any other value will be flagged as a security risk. \n \n Secure CloudFormation example:\n\n```yaml\nMyFunctionPermission:\n  Type: AWS::Lambda::Permission\n  Properties:\n    FunctionName: !GetAtt MyFunction.Arn\n    Action: lambda:InvokeFunction\n    Principal: sns.amazonaws.com\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/lambda_permission_misconfigured",
  "platform": "CloudFormation",
  "descriptionID": "dec6dd24",
  "cloudProvider": "aws",
  "cwe": "710",
  "providerUrl": "https://docs.aws.amazon.com/pt_br/AWSCloudFormation/latest/UserGuide/aws-resource-lambda-permission.html"
}
