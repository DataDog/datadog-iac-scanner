{
  "id": "f988a17f-1139-46a3-8928-f27eafd8b024",
  "queryName": "DMS endpoint MongoDB settings password exposed",
  "severity": "HIGH",
  "category": "Secret Management",
  "descriptionText": "Storing MongoDB passwords for AWS DMS endpoints in plaintext or as a parameter with a `Default` value exposes credentials in CloudFormation templates, source control, and template outputs. This increases the risk of compromise and unauthorized access.\n\n Verify the `AWS::DMS::Endpoint` resource's `Properties.MongoDbSettings.Password` is not a literal string value and is not a `Ref` to a `Parameters` entry that defines a `Default`.\n\n Instead, provide the secret via AWS Secrets Manager (CloudFormation dynamic reference) or as a parameter without a `Default` (and with `NoEcho: true`) so secrets are not embedded in the template. Resources missing a Secrets Manager reference or using parameter defaults will be flagged.\n\n Secure configuration examples:\n\n```yaml\n# Use Secrets Manager dynamic reference\nMyDmsEndpoint:\n  Type: AWS::DMS::Endpoint\n  Properties:\n    EndpointIdentifier: my-endpoint\n    EngineName: mongodb\n    MongoDbSettings:\n      Username: myuser\n      Password: '{{resolve:secretsmanager:my-secret-id:SecretString:password}}'\n```\n\n```yaml\n# Use a parameter with NoEcho and no Default\nParameters:\n  DbPassword:\n    Type: String\n    NoEcho: true\n\nMyDmsEndpoint:\n  Type: AWS::DMS::Endpoint\n  Properties:\n    EndpointIdentifier: my-endpoint\n    EngineName: mongodb\n    MongoDbSettings:\n      Username: myuser\n      Password: !Ref DbPassword\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/dms_endpoint_mongo_db_settings_password_exposed",
  "platform": "CloudFormation",
  "descriptionID": "6f895308",
  "cloudProvider": "aws",
  "cwe": "256",
  "oldSeverity": "MEDIUM",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-dms-endpoint-mongodbsettings.html"
}
