{
  "id": "acc78859-765e-4011-a229-a65ea57db252",
  "queryName": "S3 bucket allows delete action from all principals",
  "severity": "CRITICAL",
  "category": "Access Control",
  "descriptionText": "S3 bucket policies must not allow delete actions to all principals (`*`). Public delete permissions enable unauthorized users to remove or tamper with objects and buckets, causing data loss and service disruption. Check `AWS::S3::BucketPolicy` resources' `Properties.PolicyDocument.Statement` entries. Ensure no statement has `Effect: \"Allow\"` with `Principal` equal to `*` (or an array containing `*`) while `Action` includes delete operations such as `s3:DeleteObject`, `s3:DeleteBucket`, `s3:DeleteObjectVersion`, or wildcard actions that grant delete privileges.\n\nStatements that combine `Effect: \"Allow\"`, `Principal: \"*\"`, and any delete action will be flagged. Instead, restrict delete permissions to explicit principals (account IDs, ARNs, or specific service principals) or remove `Allow` for delete actions to public principals. `Action` may be a single string or a list. Both forms are checked.\n\nSecure example restricting delete to a specific AWS account:\n\n```yaml\nMyBucketPolicy:\n  Type: AWS::S3::BucketPolicy\n  Properties:\n    Bucket: my-bucket\n    PolicyDocument:\n      Statement:\n        - Sid: AllowSpecificAccountDeletes\n          Effect: Allow\n          Principal:\n            AWS: \"arn:aws:iam::123456789012:root\"\n          Action:\n            - \"s3:DeleteObject\"\n            - \"s3:DeleteObjectVersion\"\n          Resource: \"arn:aws:s3:::my-bucket/*\"\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/s3_bucket_allows_delete_actions_from_all_principals",
  "platform": "CloudFormation",
  "descriptionID": "0a34aa34",
  "cloudProvider": "aws",
  "cwe": "732",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html"
}
