{
  "id": "5b033ec8-f079-4323-b5c8-99d4620433a9",
  "queryName": "EMR security configuration encryption disabled",
  "severity": "MEDIUM",
  "category": "Encryption",
  "descriptionText": "EMR `SecurityConfiguration` must enable encryption at rest and in transit to prevent unauthorized access to data stored on cluster disks and to protect data in flight between EMR nodes from interception.\n \n For CloudFormation, resources of type `AWS::EMR::SecurityConfiguration` must define `SecurityConfiguration.EncryptionConfiguration` with `EnableAtRestEncryption` set to `true` and `EnableInTransitEncryption` set to `true`. The `AtRestEncryptionConfiguration.LocalDiskEncryptionConfiguration.EnableEbsEncryption` property must be set to `true`, and `EncryptionKeyProviderType` must be defined. Resources missing `EncryptionConfiguration`, with any of those booleans set to `false`, or without a defined `EncryptionKeyProviderType` will be flagged.\n\nSecure CloudFormation example:\n\n```yaml\nMyEMRSecurityConfiguration:\n  Type: AWS::EMR::SecurityConfiguration\n  Properties:\n    SecurityConfiguration:\n      EncryptionConfiguration:\n        EnableAtRestEncryption: true\n        EnableInTransitEncryption: true\n        AtRestEncryptionConfiguration:\n          LocalDiskEncryptionConfiguration:\n            EnableEbsEncryption: true\n            EncryptionKeyProviderType: AwsKms\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/emr_security_configuration_encryptions_enabled",
  "platform": "CloudFormation",
  "descriptionID": "672bc6a7",
  "cloudProvider": "aws",
  "cwe": "319",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-emr-securityconfiguration.html"
}