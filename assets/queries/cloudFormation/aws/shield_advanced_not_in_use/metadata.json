{
  "id": "ad7444cf-817a-4765-a79e-2145f7981faf",
  "queryName": "Shield Advanced not in use",
  "severity": "LOW",
  "category": "Networking and Firewall",
  "descriptionText": "Resources such as CloudFront distributions, Elastic Load Balancers, Global Accelerator accelerators, Elastic IPs, and Route 53 hosted zones should be protected by AWS Shield Advanced to reduce the risk of large-scale DDoS attacks that can cause prolonged service disruption and costly mitigation.\n\nThis check requires an `AWS::FMS::Policy` resource whose `Properties.SecurityServicePolicyData.Type` is set to `SHIELD_ADVANCED`. That FMS policy must include the relevant resource type in `Properties.ResourceTypeList` (for example, `AWS::CloudFront::Distribution`, `AWS::ElasticLoadBalancing::LoadBalancer`, `AWS::GlobalAccelerator::Accelerator`, `AWS::EC2::EIP`, or `AWS::Route53::HostedZone`). Resources without such an association will be flagged.\n\nSecure configuration example:\n\n```yaml\nShieldAdvancedFmsPolicy:\n  Type: AWS::FMS::Policy\n  Properties:\n    PolicyName: ShieldAdvancedPolicy\n    ResourceTypeList:\n      - AWS::CloudFront::Distribution\n      - AWS::ElasticLoadBalancing::LoadBalancer\n      - AWS::GlobalAccelerator::Accelerator\n      - AWS::EC2::EIP\n      - AWS::Route53::HostedZone\n    SecurityServicePolicyData:\n      Type: SHIELD_ADVANCED\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/shield_advanced_not_in_use",
  "platform": "CloudFormation",
  "descriptionID": "ae5e799c",
  "cloudProvider": "aws",
  "cwe": "665",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-fms-policy.html"
}
