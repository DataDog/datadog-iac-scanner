{
  "id": "e415f8d3-fc2b-4f52-88ab-1129e8c8d3f5",
  "queryName": "Fully open ingress",
  "severity": "HIGH",
  "category": "Networking and Firewall",
  "descriptionText": "Security groups attached to ECS services must not allow ingress from `0.0.0.0/0` to all ports because unrestricted public access increases the attack surface of containerized workloads and enables unauthorized access or exploitation.\n \n Check `AWS::EC2::SecurityGroupIngress` resources where `Properties.CidrIp` is `0.0.0.0/0` and `Properties.ToPort` is `0` for rules that apply to security groups used by ECS services. Such rules will be flagged. Restrict ingress by specifying trusted CIDR ranges or referencing other security groups and by narrowing `FromPort`/`ToPort` to only the ports required (or place services behind a load balancer and WAF).\n\nSecure configuration example (restrict access to TCP port 80 from a specific CIDR):\n\n```yaml\nMySecurityGroupIngress:\n  Type: AWS::EC2::SecurityGroupIngress\n  Properties:\n    GroupId: !Ref MySecurityGroup\n    IpProtocol: tcp\n    FromPort: 80\n    ToPort: 80\n    CidrIp: 203.0.113.0/24\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/fully_open_ingress",
  "platform": "CloudFormation",
  "descriptionID": "747f49ac",
  "cloudProvider": "aws",
  "cwe": "668",
  "providerUrl": "https://docs.aws.amazon.com/AmazonECS/latest/developerguide/get-set-up-for-amazon-ecs.html#create-a-base-security-group"
}
