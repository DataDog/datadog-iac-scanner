{
  "id": "0f04217d-488f-4e7a-bec8-f16159686cd6",
  "queryName": "DynamoDB table point-in-time recovery disabled",
  "severity": "MEDIUM",
  "category": "Best Practices",
  "descriptionText": "DynamoDB tables must have point-in-time recovery (PITR) enabled to allow restoration to a prior consistent state after accidental deletes, overwrites, or data corruption. Without PITR, you cannot restore to recent points in time, increasing the risk of permanent data loss and extended recovery time. Check `AWS::DynamoDB::Table` resources and ensure the `Properties.PointInTimeRecoverySpecification.PointInTimeRecoveryEnabled` property is defined and set to `true`. Resources missing `PointInTimeRecoverySpecification`, missing the `PointInTimeRecoveryEnabled` field, or with `PointInTimeRecoveryEnabled` set to `false` will be flagged.\n\nSecure configuration example:\n\n```yaml\nMyDynamoTable:\n  Type: AWS::DynamoDB::Table\n  Properties:\n    TableName: MyTable\n    AttributeDefinitions:\n      - AttributeName: id\n        AttributeType: S\n    KeySchema:\n      - AttributeName: id\n        KeyType: HASH\n    BillingMode: PAY_PER_REQUEST\n    PointInTimeRecoverySpecification:\n      PointInTimeRecoveryEnabled: true\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/dynamodb_table_point_in_time_recovery_disabled",
  "platform": "CloudFormation",
  "descriptionID": "a0a51171",
  "cloudProvider": "aws",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-dynamodb-table-pointintimerecoveryspecification.html",
  "cwe": "710"
}