{
  "id": "de76a0d6-66d5-45c9-9022-f05545b85c78",
  "queryName": "Redshift cluster without a KMS CMK",
  "severity": "MEDIUM",
  "category": "Encryption",
  "descriptionText": "Redshift clusters should specify a customer-managed AWS KMS key (`KmsKeyId`) to maintain control over encryption of data at rest and snapshots. Without a customer-managed CMK, you lose control over key rotation, access policies, and the ability to revoke or share keys. In AWS CloudFormation, the `KmsKeyId` property must be defined on `AWS::Redshift::Cluster` resources and set to the ARN or key ID of a customer-managed KMS key. Resources missing this property will be flagged because they may rely on AWS-managed keys or lack explicit encryption controls. Secure configuration example (CloudFormation YAML):\n\n```yaml\nMyRedshiftCluster:\n  Type: AWS::Redshift::Cluster\n  Properties:\n    ClusterType: single-node\n    NodeType: dc2.large\n    DBName: dev\n    MasterUsername: masteruser\n    MasterUserPassword: ReplaceWithSecurePassword\n    KmsKeyId: arn:aws:kms:us-east-1:123456789012:key/abcd1234-ef56-7890-abcd-ef1234567890\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/redshift_cluster_without_kms_cmk",
  "platform": "CloudFormation",
  "descriptionID": "e460a7a7",
  "cloudProvider": "aws",
  "cwe": "311",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html"
}
