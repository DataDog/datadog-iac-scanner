{
  "id": "7fd0d461-5b8c-4815-898c-f2b4b117eb28",
  "queryName": "API Gateway without configured authorizer",
  "severity": "MEDIUM",
  "category": "Access Control",
  "descriptionText": "APIs without an associated authorizer can accept unauthenticated or insufficiently authenticated requests, increasing the risk of unauthorized access to backend services and potential data exfiltration or abuse.\n\n For CloudFormation, each API resource of type `AWS::ApiGateway::RestApi` or `AWS::ApiGatewayV2::Api` must have a corresponding authorizer resource:\n\n - `AWS::ApiGateway::Authorizer` that sets `RestApiId` to reference the REST API\n - `AWS::ApiGatewayV2::Authorizer` that sets `ApiId` to reference the v2 API\n\n Resources missing an authorizer reference (or with no matching `RestApiId`/`ApiId`) will be flagged. The identifier may be provided as a `Ref`, `Fn::GetAtt`, a literal ARN, or another expression that resolves to the API identifier.\n\nSecure examples:\n\n```yaml\nMyRestApi:\n  Type: AWS::ApiGateway::RestApi\n  Properties:\n    Name: my-rest-api\n\nMyAuthorizer:\n  Type: AWS::ApiGateway::Authorizer\n  Properties:\n    Name: my-authorizer\n    RestApiId: !Ref MyRestApi\n    Type: TOKEN\n    AuthorizerUri: arn:aws:apigateway:region:lambda:path/2015-03-31/functions/arn:aws:lambda:region:acct:function:auth-fn/invocations\n```\n\n```yaml\nMyHttpApi:\n  Type: AWS::ApiGatewayV2::Api\n  Properties:\n    Name: my-http-api\n    ProtocolType: HTTP\n\nMyV2Authorizer:\n  Type: AWS::ApiGatewayV2::Authorizer\n  Properties:\n    Name: my-v2-authorizer\n    ApiId: !Ref MyHttpApi\n    AuthorizerType: JWT\n    IdentitySource:\n      - \"$request.header.Authorization\"\n    JwtConfiguration:\n      issuer: \"https://cognito-idp.region.amazonaws.com/POOL_ID\"\n      audience:\n        - CLIENT_ID\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/api_gateway_without_configured_authorizer",
  "platform": "CloudFormation",
  "descriptionID": "5734fbc7",
  "cloudProvider": "aws",
  "cwe": "284",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-authorizer.html"
}