{
  "id": "3e293410-d5b8-411f-85fd-7d26294f20c9",
  "queryName": "VPC without Network Firewall",
  "severity": "MEDIUM",
  "category": "Networking and Firewall",
  "descriptionText": "VPCs should be associated with AWS Network Firewall to enable centralized traffic inspection and enforcement of network policies. This helps prevent lateral movement and detect or block malicious east–west and north–south traffic.\n\nThis rule checks CloudFormation for `AWS::EC2::VPC` resources that are not referenced by any `AWS::NetworkFirewall::Firewall` via the firewall's `Properties.VpcId`. The `VpcId` property in `AWS::NetworkFirewall::Firewall` must reference the VPC (for example, using `Ref` to the VPC logical ID). VPC resources without an associated `AWS::NetworkFirewall::Firewall` will be flagged.\n\nSecure configuration example (Network Firewall referencing the VPC):\n\n```yaml\nMyVPC:\n  Type: AWS::EC2::VPC\n  Properties:\n    CidrBlock: 10.0.0.0/16\n\nMyNetworkFirewall:\n  Type: AWS::NetworkFirewall::Firewall\n  Properties:\n    FirewallName: my-firewall\n    VpcId:\n      Ref: MyVPC\n    SubnetMappings:\n      - SubnetId: subnet-0123456789abcdef0\n    FirewallPolicyArn: arn:aws:network-firewall:us-east-1:123456789012:firewall-policy/example-policy\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/vpc_without_network_firewall",
  "platform": "CloudFormation",
  "descriptionID": "f090ffd2",
  "cloudProvider": "aws",
  "cwe": "665",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-networkfirewall-firewall.html#cfn-networkfirewall-firewall-vpcid"
}