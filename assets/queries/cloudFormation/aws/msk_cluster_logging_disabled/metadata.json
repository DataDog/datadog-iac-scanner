{
  "id": "fc7c2c15-f5d0-4b80-adb2-c89019f8f62b",
  "queryName": "MSK cluster logging disabled",
  "severity": "MEDIUM",
  "category": "Observability",
  "descriptionText": "MSK clusters must have broker logging enabled to provide audit and operational visibility. Without broker logs, you may be unable to detect or investigate security incidents, troubleshoot cluster issues, or meet logging retention and compliance requirements. In AWS CloudFormation, the `AWS::MSK::Cluster` resource must include the `LoggingInfo` property with `BrokerLogs` configured to specify at least one destination (`CloudWatchLogs`, `Firehose`, or `S3`). The selected destination entry must have `Enabled` set to `true`. Resources missing `LoggingInfo`, missing all three broker log destinations, or where none of the `BrokerLogs` entries have `Enabled` set to `true` will be flagged.\n\nSecure configuration example (CloudFormation YAML):\n\n```yaml\nMyMSKCluster:\n  Type: AWS::MSK::Cluster\n  Properties:\n    ClusterName: my-msk-cluster\n    KafkaVersion: \"2.8.1\"\n    NumberOfBrokerNodes: 3\n    BrokerNodeGroupInfo:\n      InstanceType: kafka.m5.large\n      ClientSubnets: [subnet-12345, subnet-67890]\n      SecurityGroups: [sg-012345]\n    LoggingInfo:\n      BrokerLogs:\n        CloudWatchLogs:\n          Enabled: true\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/msk_cluster_logging_disabled",
  "platform": "CloudFormation",
  "descriptionID": "1d9a0a75",
  "cloudProvider": "aws",
  "cwe": "778",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-msk-cluster.html"
}
