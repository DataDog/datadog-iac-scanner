{
  "id": "3b316b05-564c-44a7-9c3f-405bb95e211e",
  "queryName": "Redshift not encrypted",
  "severity": "HIGH",
  "category": "Encryption",
  "descriptionText": "Redshift clusters must have storage encryption enabled to protect sensitive data at rest and to ensure snapshots and automated backups are encrypted and not exposed if storage media is compromised. In AWS CloudFormation, the `Encrypted` property on `AWS::Redshift::Cluster` resources must be defined and set to `true`. Resources missing this property or with `Encrypted` set to `false` will be flagged. If `Encrypted` is omitted, the default behavior is `false`. For key management, set `KmsKeyId` to a customer-managed KMS key ARN or alias when you require control over encryption keys. If omitted, AWS will use the AWS-managed key.\n\nSecure configuration example:\n\n```yaml\nMyRedshiftCluster:\n  Type: AWS::Redshift::Cluster\n  Properties:\n    ClusterType: single-node\n    NodeType: dc2.large\n    DBName: mydb\n    MasterUsername: masteruser\n    MasterUserPassword: ReplaceWithSecureValue\n    Encrypted: true\n    KmsKeyId: arn:aws:kms:us-east-1:123456789012:key/abcd-1234-efgh-5678\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/redshift_not_encrypted",
  "platform": "CloudFormation",
  "descriptionID": "5605695c",
  "cloudProvider": "aws",
  "cwe": "311",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-redshift-cluster.html"
}