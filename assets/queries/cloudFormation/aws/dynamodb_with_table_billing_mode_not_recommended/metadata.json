{
  "id": "c333e906-8d8b-4275-b999-78b6318f8dc6",
  "queryName": "DynamoDB with non-recommended table billing mode",
  "severity": "LOW",
  "category": "Build Process",
  "descriptionText": "DynamoDB tables must explicitly specify a valid billing mode to ensure predictable capacity behavior and to avoid deploying tables with undefined or unexpected throughput that can impact availability. In CloudFormation, the `BillingMode` property on `AWS::DynamoDB::Table` must be set to either `PROVISIONED` or `PAY_PER_REQUEST`. Resources missing the `BillingMode` property or using any other value will be flagged. If you choose `PROVISIONED`, also configure appropriate provisioned throughput or auto-scaling. If you choose `PAY_PER_REQUEST`, do not define `ProvisionedThroughput`.\n\nSecure example using on-demand (PAY_PER_REQUEST):\n\n```yaml\nMyDynamoTable:\n  Type: AWS::DynamoDB::Table\n  Properties:\n    TableName: my-table\n    BillingMode: PAY_PER_REQUEST\n```\n\nSecure example using provisioned capacity:\n\n```yaml\nMyDynamoTable:\n  Type: AWS::DynamoDB::Table\n  Properties:\n    TableName: my-table\n    BillingMode: PROVISIONED\n    ProvisionedThroughput:\n      ReadCapacityUnits: 5\n      WriteCapacityUnits: 5\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/dynamodb_with_table_billing_mode_not_recommended",
  "platform": "CloudFormation",
  "descriptionID": "2a9dc4de",
  "cloudProvider": "aws",
  "cwe": "913",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-dynamodb-table.html#cfn-dynamodb-table-attributedef"
}
