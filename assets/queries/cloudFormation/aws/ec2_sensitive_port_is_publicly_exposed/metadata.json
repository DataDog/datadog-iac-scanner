{
  "id": "494b03d3-bf40-4464-8524-7c56ad0700ed",
  "queryName": "EC2 sensitive port is publicly exposed",
  "severity": "HIGH",
  "category": "Networking and Firewall",
  "descriptionText": "Security group ingress rules must not expose known sensitive service ports to the entire internet (for example, `0.0.0.0/0` or `::/0`) because this makes EC2 instances reachable for unauthorized access, brute-force attacks, and exploitation of network services.\n \n This check inspects `AWS::EC2::SecurityGroup` resources that are attached to `AWS::EC2::Instance` (via the instance's `SecurityGroups` property). It flags `SecurityGroupIngress` entries where the `CidrIp` value ends with `/0` and the `IpProtocol` plus `FromPort`â€“`ToPort` range includes known sensitive ports (for example, SSH `22`, RDP `3389`, and common database ports). The rule evaluates `IpProtocol` values of `-1`/`ALL` as both TCP and UDP and supports port ranges when mapping to sensitive services.\n \n Remediate by restricting `CidrIp` to specific trusted CIDR ranges, using source security groups, or placing access behind bastion hosts or VPNs.\n\nSecure configuration example:\n\n```yaml\nMySecurityGroup:\n  Type: AWS::EC2::SecurityGroup\n  Properties:\n    GroupDescription: Allow SSH from admin network\n    SecurityGroupIngress:\n      - IpProtocol: tcp\n        FromPort: 22\n        ToPort: 22\n        CidrIp: 10.0.0.0/24\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/ec2_sensitive_port_is_publicly_exposed",
  "platform": "CloudFormation",
  "descriptionID": "680b7e89",
  "aggregation": 61,
  "cloudProvider": "aws",
  "cwe": "668",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html"
}