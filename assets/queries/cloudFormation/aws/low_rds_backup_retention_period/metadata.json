{
  "id": "e649a218-d099-4550-86a4-1231e1fcb60d",
  "queryName": "Low RDS backup retention period",
  "severity": "LOW",
  "category": "Backup",
  "descriptionText": "RDS clusters and standalone instances must retain automated backups for at least `7` days to ensure recoverability and limit data loss from accidental deletion, corruption, or operational errors. In AWS CloudFormation, the `BackupRetentionPeriod` property on `AWS::RDS::DBCluster` (and on standalone `AWS::RDS::DBInstance` resources) must be defined and set to `7` or greater. This rule flags `AWS::RDS::DBCluster` resources that omit `BackupRetentionPeriod` or set it to a value less than `7`. For `AWS::RDS::DBInstance` resources, the check is enforced only when no `AWS::RDS::DBCluster` resources are defined in the template because cluster-level backup retention may govern recovery for clustered deployments. Resources missing the property or with `BackupRetentionPeriod` less than `7` will be reported.\n\nSecure configuration examples:\n\n```yaml\nMyDBCluster:\n  Type: AWS::RDS::DBCluster\n  Properties:\n    Engine: aurora-mysql\n    BackupRetentionPeriod: 7\n```\n\n```yaml\nMyDBInstance:\n  Type: AWS::RDS::DBInstance\n  Properties:\n    DBInstanceClass: db.t3.medium\n    Engine: mysql\n    BackupRetentionPeriod: 7\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/low_rds_backup_retention_period",
  "platform": "CloudFormation",
  "descriptionID": "55094eb2",
  "cloudProvider": "aws",
  "cwe": "778",
  "oldSeverity": "MEDIUM",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html"
}
