{
  "id": "78055456-f670-4d2e-94d5-392d1cf4f5e4",
  "queryName": "ELB sensitive port is exposed to entire network",
  "severity": "HIGH",
  "category": "Networking and Firewall",
  "descriptionText": "Load balancer security groups that allow ingress from the entire internet (for example, `0.0.0.0/0` or `::/0`) to sensitive ports expose management, database, and application endpoints to unauthorized access and exploitation.\n \n Check load balancer resources (`AWS::ElasticLoadBalancing::LoadBalancer` and `AWS::ElasticLoadBalancingV2::LoadBalancer`) and their referenced security groups. Examine `SecurityGroupIngress` entries (`Properties.SecurityGroupIngress`) for `IpProtocol`, `FromPort`/`ToPort`, and `CidrIp`. The `CidrIp` value must not be a `/0` range for ports that map to sensitive services (for example, SSH `22`, RDP `3389`, and database ports).\n \n If a load balancer lists `SecurityGroups`, validate those `AWS::EC2::SecurityGroup` resources. If the load balancer is associated via Amazon EC2 instances, validate those instances' `Properties.SecurityGroups` as well. Ingress rules that include a `/0` CIDR covering the flagged ports will be reported.\n\nSecure example restricting SSH to a single admin IP:\n\n```yaml\nAdminSG:\n  Type: AWS::EC2::SecurityGroup\n  Properties:\n    GroupDescription: Restrict SSH to admin workstation\n    VpcId: vpc-01234567\n    SecurityGroupIngress:\n      - IpProtocol: tcp\n        FromPort: 22\n        ToPort: 22\n        CidrIp: 203.0.113.5/32\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/elb_sensitive_port_is_exposed_to_entire_network",
  "platform": "CloudFormation",
  "descriptionID": "f26797b1",
  "aggregation": 183,
  "cloudProvider": "aws",
  "cwe": "668",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb.html"
}
