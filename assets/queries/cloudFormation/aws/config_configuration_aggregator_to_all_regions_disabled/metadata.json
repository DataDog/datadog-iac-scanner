{
  "id": "9f3cf08e-72a2-4eb1-8007-e3b1b0e10d4d",
  "queryName": "Configuration aggregator to all regions disabled",
  "severity": "LOW",
  "category": "Observability",
  "descriptionText": "Configuration Aggregators that do not collect data from all AWS Regions create cross-region blind spots, which can lead to incomplete compliance monitoring and limit forensic investigation during incidents.\n\n For resources of type `AWS::Config::ConfigurationAggregator`, each entry in `AccountAggregationSources` and the `OrganizationAggregationSource` property must include the `AllAwsRegions` attribute set to `true`. Resources that omit aggregation sources, omit the `AllAwsRegions` key, or set `AllAwsRegions` to `false` will be flagged. \n \n Secure configuration example (CloudFormation YAML):\n\n```yaml\nMyConfigAggregator:\n  Type: AWS::Config::ConfigurationAggregator\n  Properties:\n    AccountAggregationSources:\n      - AccountIds: [\"111111111111\"]\n        AllAwsRegions: true\n    OrganizationAggregationSource:\n      RoleArn: arn:aws:iam::111111111111:role/ConfigAggregatorRole\n      AllAwsRegions: true\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/config_configuration_aggregator_to_all_regions_disabled",
  "platform": "CloudFormation",
  "descriptionID": "fb6e5346",
  "cloudProvider": "aws",
  "cwe": "710",
  "oldSeverity": "MEDIUM",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configurationaggregator.html"
}
