{
  "id": "f6397a20-4cf1-4540-a997-1d363c25ef58",
  "queryName": "S3 bucket allows put action from all principals",
  "severity": "CRITICAL",
  "category": "Access Control",
  "descriptionText": "Bucket policies that allow S3 Put actions from the wildcard principal (`*`) enable anyone on the internet to upload or overwrite objects in the bucket. This can lead to unauthorized data tampering, malware uploads, or public exposure of sensitive content.\n\nCheck `AWS::S3::BucketPolicy` resources' `Properties.PolicyDocument.Statement` entries and flag statements where `Effect: \"Allow\"`, `Principal: \"*\"`, and `Action` includes Put operations such as `s3:PutObject` (or other `s3:Put*` actions). `Principal` should specify explicit principals (AWS account IDs, IAM role/user ARNs, or canonical user IDs). If `Principal` is `*`, the statement must include strict conditions (for example, `SourceIp` or `VpcEndpoint`) that effectively prevent public uploads. Statements with `Principal: \"*\"` and unrestrained Put actions will be flagged.\n\nSecure configuration example allowing Put only to a specific role:\n\n```yaml\nMyBucketPolicy:\n  Type: AWS::S3::BucketPolicy\n  Properties:\n    Bucket: !Ref MyBucket\n    PolicyDocument:\n      Version: \"2012-10-17\"\n      Statement:\n        - Effect: Allow\n          Principal:\n            AWS: arn:aws:iam::123456789012:role/UploadRole\n          Action:\n            - s3:PutObject\n          Resource: arn:aws:s3:::my-bucket/*\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/s3_bucket_allows_put_actions_from_all_principals",
  "platform": "CloudFormation",
  "descriptionID": "9d094f81",
  "cloudProvider": "aws",
  "cwe": "732",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html"
}
