{
  "id": "08b81bb3-0985-4023-8602-b606ad81d279",
  "queryName": "EC2 instance using default security group",
  "severity": "MEDIUM",
  "category": "Access Control",
  "descriptionText": "Attaching EC2 instances to the VPC default security group increases risk because the default group is typically shared, often permits broad intra‑VPC traffic, and cannot be tightly scoped, which facilitates lateral movement and unintended access.\n \n This rule checks `AWS::EC2::Instance` resources and inspects the `SecurityGroups` and `SecurityGroupIds` properties. Any entry that references or names the default security group (case‑insensitive match for `default`) will be flagged. The check evaluates both literal values and `Ref` references, so entries containing `default` or pointing to a default security group resource are considered noncompliant.\n \n Use explicit, purpose‑built security groups with restrictive ingress/egress rules and reference those group IDs or logical names instead of the default group.\n\nSecure configuration example:\n\n```yaml\nMySecurityGroup:\n  Type: AWS::EC2::SecurityGroup\n  Properties:\n    GroupDescription: Web server security group\n    VpcId: !Ref MyVPC\n    SecurityGroupIngress:\n      - IpProtocol: tcp\n        FromPort: 443\n        ToPort: 443\n        CidrIp: 0.0.0.0/0\n\nMyInstance:\n  Type: AWS::EC2::Instance\n  Properties:\n    ImageId: ami-0abcdef1234567890\n    InstanceType: t3.micro\n    SecurityGroupIds:\n      - !Ref MySecurityGroup\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/ec2_instance_using_default_security_group",
  "platform": "CloudFormation",
  "descriptionID": "de993e1a",
  "cloudProvider": "aws",
  "cwe": "284",
  "oldSeverity": "LOW",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-instance.html#cfn-ec2-instance-securitygroups"
}