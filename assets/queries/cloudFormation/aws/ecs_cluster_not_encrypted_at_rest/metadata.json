{
  "id": "6c131358-c54d-419b-9dd6-1f7dd41d180c",
  "queryName": "ECS cluster not encrypted at rest",
  "severity": "HIGH",
  "category": "Encryption",
  "descriptionText": "Amazon EFS transit encryption must be enabled for Amazon ECS task definitions that mount EFS volumes. This protects data in transit between containers and the EFS file system from interception or tampering and can help meet common compliance requirements.\n \n In CloudFormation, inspect the `AWS::ECS::Service` resource's `TaskDefinition` reference. Then verify the referenced `AWS::ECS::TaskDefinition` resource has `Properties.Volumes[].EFSVolumeConfiguration.TransitEncryption` set to `ENABLED`. Resources will be flagged if the referenced task definition is missing, or if any volume has `TransitEncryption` set to `DISABLED` or is not defined. Secure example task definition configuration:\n\n```yaml\nMyTaskDefinition:\n  Type: AWS::ECS::TaskDefinition\n  Properties:\n    ContainerDefinitions:\n      - Name: app\n        Image: my-image\n    Volumes:\n      - Name: efsVolume\n        EFSVolumeConfiguration:\n          FileSystemId: fs-0123456789abcdef0\n          TransitEncryption: ENABLED\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/ecs_cluster_not_encrypted_at_rest",
  "platform": "CloudFormation",
  "descriptionID": "512ea20d",
  "cloudProvider": "aws",
  "cwe": "311",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-ecs-taskdefinition.html"
}
