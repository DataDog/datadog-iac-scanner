{
  "id": "4ae8af91-5108-42cb-9471-3bdbe596eac9",
  "queryName": "S3 bucket with all permissions",
  "severity": "CRITICAL",
  "category": "Access Control",
  "descriptionText": "S3 bucket policies must not grant `Allow` for all actions to all principals. This creates public full access to the bucket and can result in data exposure, tampering, or deletion.\n\nCheck `AWS::S3::BucketPolicy` resources' `Properties.PolicyDocument.Statement` entries and flag any statement where `Effect: \"Allow\"`, `Action: \"*\"`, and `Principal: \"*\"`. Statements matching these conditions will be reported. Restrict principals to specific AWS account IDs/ARNs or services and limit `Action` to the minimum required S3 operations instead of using wildcards.\n\nSecure example limiting access to a specific account and action:\n\n```yaml\nMyBucketPolicy:\n  Type: AWS::S3::BucketPolicy\n  Properties:\n    Bucket: !Ref MyBucket\n    PolicyDocument:\n      Version: '2012-10-17'\n      Statement:\n        - Effect: Allow\n          Principal:\n            AWS: arn:aws:iam::123456789012:root\n          Action:\n            - s3:GetObject\n          Resource: !Sub '${MyBucket.Arn}/*'\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/s3_bucket_with_all_permissions",
  "platform": "CloudFormation",
  "descriptionID": "65883f5a",
  "cloudProvider": "aws",
  "cwe": "732",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html"
}