{
  "id": "1fe9d958-ddce-4228-a124-05265a959a8b",
  "queryName": "RDS using default port",
  "severity": "LOW",
  "category": "Networking and Firewall",
  "descriptionText": "Using an RDS instance's default database port makes the service easy for attackers to discover and target with automated scanners, brute-force attempts, and opportunistic exploits. Instances should not listen on the engine's well-known port. This rule checks `AWS::RDS::DBInstance` resources and flags `Properties.Port` when it is explicitly set to the engine's default value. Default ports checked include Aurora, MariaDB, and MySQL (`3306`), PostgreSQL (`5432`), Oracle (`1521`), and SQL Server (`1433`). If you must use a common port for compatibility, restrict access with tight security group, subnet, and network controls rather than relying on port obscurity.\n\nSecure configuration example (PostgreSQL on non-default port):\n\n```yaml\nMyDBInstance:\n  Type: AWS::RDS::DBInstance\n  Properties:\n    DBInstanceIdentifier: my-db\n    Engine: postgres\n    EngineVersion: '14.7'\n    DBInstanceClass: db.t3.micro\n    AllocatedStorage: 20\n    Port: 5433\n    MasterUsername: admin\n    MasterUserPassword: !Ref DBPassword\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/rds_using_default_port",
  "platform": "CloudFormation",
  "descriptionID": "b5d8d0b5",
  "cloudProvider": "aws",
  "cwe": "668",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html#cfn-rds-dbinstance-port"
}
