{
  "id": "4c137350-7307-4803-8c04-17c09a7a9fcf",
  "queryName": "Root account has active access keys",
  "severity": "HIGH",
  "category": "Insecure Configurations",
  "descriptionText": "Access keys associated with the AWS root account grant persistent, account-wide credentials. If compromised, they can lead to full account takeover and loss of control over all resources.\n\nIn CloudFormation, `AWS::IAM::AccessKey` resources must not be associated with the root account. This rule flags `Resources.<name>.Properties.UserName` values that contain `root` (case-insensitive). Instead of creating or using root access keys, delete or deactivate any existing root keys, enable MFA on the root account, and provision IAM users or roles with least privilege for programmatic access.\n\nSecure configuration example (associate access keys with an IAM user rather than the root account):\n\n```yaml\nMyUser:\n  Type: AWS::IAM::User\n  Properties:\n    UserName: app-user\n\nMyAccessKey:\n  Type: AWS::IAM::AccessKey\n  Properties:\n    UserName: !Ref MyUser\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/root_account_has_active_access_keys",
  "platform": "CloudFormation",
  "descriptionID": "195ebcdb",
  "cloudProvider": "aws",
  "cwe": "710",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-iam-accesskey.html"
}