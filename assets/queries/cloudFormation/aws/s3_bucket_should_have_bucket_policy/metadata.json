{
  "id": "37fa8188-738b-42c8-bf82-6334ea567738",
  "queryName": "S3 bucket should have bucket policy",
  "severity": "LOW",
  "category": "Insecure Defaults",
  "descriptionText": "S3 buckets should have an associated bucket policy so explicit access controls can be enforced. This reduces the risk of unintended public or overly broad access to bucket contents.\n\nThis rule checks `AWS::S3::Bucket` resources for a matching `AWS::S3::BucketPolicy` whose `Bucket` property references the same bucket. The policy may reference the bucket using a `Ref` to the bucket's logical ID, or by matching the bucket's `BucketName` property.\n\nResources missing a matching `AWS::S3::BucketPolicy`, or policies that reference a different identifier, will be flagged. If you omit `BucketName` (letting CloudFormation generate the name), ensure the policy uses `!Ref` to the bucket. If you provide an explicit `BucketName`, the policy may reference that literal name.\n\nSecure configuration example:\n\n```yaml\nMyBucket:\n  Type: AWS::S3::Bucket\n  Properties:\n    BucketName: my-bucket-name\n\nMyBucketPolicy:\n  Type: AWS::S3::BucketPolicy\n  Properties:\n    Bucket: !Ref MyBucket\n    PolicyDocument:\n      Version: \"2012-10-17\"\n      Statement:\n        - Effect: Allow\n          Principal:\n            AWS: \"arn:aws:iam::123456789012:role/ReadOnlyRole\"\n          Action: \"s3:GetObject\"\n          Resource: !Sub \"arn:aws:s3:::${MyBucket}/*\"\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/s3_bucket_should_have_bucket_policy",
  "platform": "CloudFormation",
  "descriptionID": "2b429546",
  "cloudProvider": "aws",
  "cwe": "665",
  "oldSeverity": "MEDIUM",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html"
}
