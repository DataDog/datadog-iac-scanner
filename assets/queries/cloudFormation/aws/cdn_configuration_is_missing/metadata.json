{
  "id": "e4f54ff4-d352-40e8-a096-5141073c37a2",
  "queryName": "CDN configuration is missing",
  "severity": "LOW",
  "category": "Best Practices",
  "descriptionText": "CloudFront distributions must be active and include at least one origin so client traffic is routed through CloudFront's caching and security controls (for example, AWS WAF, AWS Shield, and origin access controls). Without an active distribution or defined origins, traffic can bypass these protections and origins can be exposed to direct access and increased attack surface.\n\n In CloudFormation, ensure resources of type `AWS::CloudFront::Distribution` set `Properties.DistributionConfig.Enabled` to `true` and that `Properties.DistributionConfig` contains an `Origins` entry with at least one origin definition. Resources missing the `Origins` object or with `Enabled` set to `false` (or the string `\"false\"`) will be flagged.\n\n For S3 origins, also configure origin access identity (OAI) or origin access control (OAC), and ensure each origin includes required fields such as `Id` and `DomainName` to prevent unintended public access.\n\nSecure configuration example:\n\n```yaml\nMyDistribution:\n  Type: AWS::CloudFront::Distribution\n  Properties:\n    DistributionConfig:\n      Enabled: true\n      Origins:\n        - Id: myS3Origin\n          DomainName: my-bucket.s3.amazonaws.com\n          S3OriginConfig: {}\n      DefaultCacheBehavior:\n        TargetOriginId: myS3Origin\n        ViewerProtocolPolicy: redirect-to-https\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/cdn_configuration_is_missing",
  "platform": "CloudFormation",
  "descriptionID": "6a8090b9",
  "cloudProvider": "aws",
  "cwe": "710",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-cloudfront-distribution-distributionconfig.html"
}
