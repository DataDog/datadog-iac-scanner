{
  "id": "0104165b-02d5-426f-abc9-91fb48189899",
  "queryName": "DB security group open to large scope",
  "severity": "HIGH",
  "category": "Networking and Firewall",
  "descriptionText": "Ingress rules that use large CIDR blocks grant network access to hundreds or thousands of hosts. This increases attack surface and raises the risk of unauthorized access, brute-force attacks, and lateral movement.\n\n For CloudFormation:\n - For `AWS::EC2::SecurityGroup` resources, `Properties.SecurityGroupIngress` IPv4 entries (`CidrIp`) must use prefix lengths of `/25` through `/32`, and IPv6 entries (`CidrIpv6`) must use `/120` through `/128`.\n - For `AWS::RDS::DBSecurityGroup` resources, `DBSecurityGroupIngress.CIDRIP` IPv4 values must also use `/25` through `/32`.\n\n Resources missing these properties or that specify less specific prefixes (for example, `/24` or shorter for IPv4, or `/119` or shorter for IPv6) will be flagged. Remediate by replacing broad CIDR blocks with narrower CIDRs, specific host addresses, or security-group references so each ingress entry meets the required prefix length.\n\nSecure examples (CloudFormation YAML):\n\n```yaml\nMySecurityGroup:\n  Type: AWS::EC2::SecurityGroup\n  Properties:\n    GroupDescription: Allow limited IPv4 and IPv6 access\n    SecurityGroupIngress:\n      - IpProtocol: tcp\n        FromPort: 443\n        ToPort: 443\n        CidrIp: 203.0.113.0/25\n      - IpProtocol: tcp\n        FromPort: 443\n        ToPort: 443\n        CidrIpv6: 2001:db8::/120\n```\n\n```yaml\nMyDBSecurityGroup:\n  Type: AWS::RDS::DBSecurityGroup\n  Properties:\n    DBSecurityGroupIngress:\n      - CIDRIP: 203.0.113.0/25\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/db_security_group_open_to_large_scope",
  "platform": "CloudFormation",
  "descriptionID": "feeb965a",
  "cloudProvider": "aws",
  "cwe": "668",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html"
}
