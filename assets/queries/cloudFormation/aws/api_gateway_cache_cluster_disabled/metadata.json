{
  "id": "52790cad-d60d-41d5-8483-146f9f21208d",
  "queryName": "API Gateway cache cluster disabled",
  "severity": "LOW",
  "category": "Insecure Configurations",
  "descriptionText": "API Gateway stages should have cache clustering enabled to reduce repeated backend requests and lower latency, helping prevent backend overload and service degradation. The `CacheClusterEnabled` property on `AWS::ApiGateway::Stage` resources must be defined and set to `true`. Resources missing this property or with `CacheClusterEnabled` set to `false` will be flagged. The `CacheClusterSize` property should also be configured to provision adequate cache capacity for expected traffic.\n\nSecure configuration example:\n\n```yaml\nMyStage:\n  Type: AWS::ApiGateway::Stage\n  Properties:\n    StageName: prod\n    RestApiId: !Ref MyApi\n    CacheClusterEnabled: true\n    CacheClusterSize: '0.5'\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/api_gateway_cache_cluster_disabled",
  "platform": "CloudFormation",
  "descriptionID": "c5c1c902",
  "cloudProvider": "aws",
  "cwe": "778",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-apigateway-stage.html#cfn-apigateway-stage-cacheclusterenabled"
}