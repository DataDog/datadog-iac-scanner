{
  "id": "edbd62d4-8700-41de-b000-b3cfebb5e996",
  "queryName": "Elasticsearch logs disabled",
  "severity": "MEDIUM",
  "category": "Observability",
  "descriptionText": "Elasticsearch domains must publish slow logs, application logs, and audit logs so you can detect suspicious or malicious activity and perform operational troubleshooting and compliance auditing.\n \n In CloudFormation, `AWS::Elasticsearch::Domain` resources must define `Properties.LogPublishingOptions` entries for each relevant log type (`INDEX_SLOW_LOGS`, `SEARCH_SLOW_LOGS`, `ES_APPLICATION_LOGS`, `AUDIT_LOGS`). For each entry, the `Enabled` property must be set to `true`. Resources that omit `LogPublishingOptions`, omit an `Enabled` key for a log type, or have `Enabled` set to `false` will be flagged. \n \n Secure configuration example (enable each log type and point to an Amazon CloudWatch Logs log group):\n\n```yaml\nMyDomain:\n  Type: AWS::Elasticsearch::Domain\n  Properties:\n    DomainName: my-domain\n    LogPublishingOptions:\n      INDEX_SLOW_LOGS:\n        CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:es-index-slow\n        Enabled: true\n      SEARCH_SLOW_LOGS:\n        CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:es-search-slow\n        Enabled: true\n      ES_APPLICATION_LOGS:\n        CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:es-app-logs\n        Enabled: true\n      AUDIT_LOGS:\n        CloudWatchLogsLogGroupArn: arn:aws:logs:us-east-1:123456789012:log-group:es-audit-logs\n        Enabled: true\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/elasticsearch_logs_disabled",
  "platform": "CloudFormation",
  "descriptionID": "e2451952",
  "cloudProvider": "aws",
  "cwe": "",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html#cfn-elasticsearch-domain-logpublishingoptions"
}
