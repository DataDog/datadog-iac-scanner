{
  "id": "275a3217-ca37-40c1-a6cf-bb57d245ab32",
  "queryName": "ALB listening on HTTP",
  "severity": "MEDIUM",
  "category": "Networking and Firewall",
  "descriptionText": "Listeners must not use plain HTTP because unencrypted traffic can be intercepted or modified in transit, exposing sensitive data and enabling session hijacking or credential theft.\n\n For `AWS::ElasticLoadBalancing::LoadBalancer` resources, ensure no entry in `Properties.Listeners` has `Protocol` set to `HTTP`. Listeners should use `HTTPS` and include an SSL certificate (`SSLCertificateId`).\n\n For `AWS::ElasticLoadBalancingV2::Listener` resources, ensure `Properties.Protocol` is not `HTTP`. Listeners should use `HTTPS` with a `Certificates` entry and an appropriate `SslPolicy`.\n\n Resources with listeners configured as `HTTP` will be flagged. When migrating to HTTPS, also ensure backend/target group protocols and health checks are updated and a valid certificate ARN is provided.\n\nSecure configuration examples:\n\n```yaml\nMyClassicLoadBalancer:\n  Type: AWS::ElasticLoadBalancing::LoadBalancer\n  Properties:\n    Listeners:\n      - Protocol: HTTPS\n        LoadBalancerPort: 443\n        InstanceProtocol: HTTPS\n        InstancePort: 443\n        SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-cert\n```\n\n```yaml\nMyALBListener:\n  Type: AWS::ElasticLoadBalancingV2::Listener\n  Properties:\n    Protocol: HTTPS\n    Port: 443\n    Certificates:\n      - CertificateArn: arn:aws:acm:us-east-1:123456789012:certificate/abcd-ef01-2345\n    DefaultActions:\n      - Type: forward\n        TargetGroupArn: !Ref MyTargetGroup\n    SslPolicy: ELBSecurityPolicy-2016-08\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/alb_listening_on_http",
  "platform": "CloudFormation",
  "descriptionID": "55f05412",
  "cloudProvider": "aws",
  "cwe": "319",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb-listener.html#cfn-ec2-elb-listener-protocol"
}