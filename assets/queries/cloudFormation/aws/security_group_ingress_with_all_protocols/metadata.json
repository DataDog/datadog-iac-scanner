{
  "id": "1a427b25-2e9e-4298-9530-0499a55e736b",
  "queryName": "Security group ingress with all protocols",
  "severity": "MEDIUM",
  "category": "Networking and Firewall",
  "descriptionText": "Setting `IpProtocol` to `-1` allows all protocols and all ports. This greatly increases attack surface and can expose services or enable lateral movement if an ingress rule is too permissive.\n\nCheck `AWS::EC2::SecurityGroupIngress` resources and `AWS::EC2::SecurityGroup` resources' `SecurityGroupIngress` entries. `IpProtocol` must not be set to `-1`. Resources with `IpProtocol: -1` will be flagged. Specify explicit protocols (for example, `tcp`, `udp`, or `icmp`, or their numeric protocol values) and define `FromPort`/`ToPort` where applicable. If broader access is required, restrict the source to a specific CIDR or use a referenced security group.\n\nSecure configuration examples:\n\n```yaml\nMyIngressRule:\n  Type: AWS::EC2::SecurityGroupIngress\n  Properties:\n    IpProtocol: tcp\n    FromPort: 443\n    ToPort: 443\n    CidrIp: 10.0.0.0/24\n```\n\n```yaml\nMySecurityGroup:\n  Type: AWS::EC2::SecurityGroup\n  Properties:\n    GroupDescription: Example SG\n    SecurityGroupIngress:\n      - IpProtocol: tcp\n        FromPort: 22\n        ToPort: 22\n        CidrIp: 203.0.113.5/32\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/security_group_ingress_with_all_protocols",
  "platform": "CloudFormation",
  "descriptionID": "c067ceb5",
  "cloudProvider": "aws",
  "cwe": "200",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html"
}