{
  "id": "06b9f52a-8cd5-459b-bdc6-21a22521e1be",
  "queryName": "Directory service Microsoft AD password set to plaintext or default ref",
  "severity": "HIGH",
  "category": "Secret Management",
  "descriptionText": "Storing Microsoft AD passwords in plaintext or as a parameter `Default` in CloudFormation exposes credentials to source control, template archives, and other readers. This can enable unauthorized access to the directory and lateral movement across your environment.\n\n For resources of type `AWS::DirectoryService::MicrosoftAD`, `Properties.Password` must not be a literal string or a `Ref` to a `Parameters.<Name>` that defines a `Default` password.\n\n Instead, `Password` should reference a secure secret (for example, an AWS Secrets Manager secret or an AWS Systems Manager Parameter Store `SecureString` parameter) or be supplied via a CloudFormation parameter that has no `Default` and uses `NoEcho` set to `true`. This rule flags `Password` values that are plaintext or that point to a parameter with a `Default` value matching a password pattern. Remove parameter defaults containing secrets and prefer Secrets Manager references or parameterized input at deployment time.\n\nSecure examples:\n\n```yaml\nMyDirectory:\n  Type: AWS::DirectoryService::MicrosoftAD\n  Properties:\n    Name: corp.example.com\n    Password: '{{resolve:secretsmanager:my-secret-id:SecretString:password}}'\n    VpcSettings:\n      VpcId: vpc-123456\n      SubnetIds:\n        - subnet-abc\n        - subnet-def\n```\n\n```yaml\nParameters:\n  ADPassword:\n    Type: String\n    NoEcho: true\n\nMyDirectory:\n  Type: AWS::DirectoryService::MicrosoftAD\n  Properties:\n    Name: corp.example.com\n    Password: !Ref ADPassword\n    VpcSettings:\n      VpcId: vpc-123456\n      SubnetIds:\n        - subnet-abc\n        - subnet-def\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/directory_service_microsoft_ad_password_set_to_plaintext_or_default_ref",
  "platform": "CloudFormation",
  "descriptionID": "98a72cac",
  "cloudProvider": "aws",
  "cwe": "256",
  "oldSeverity": "MEDIUM",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-directoryservice-microsoftad.html"
}