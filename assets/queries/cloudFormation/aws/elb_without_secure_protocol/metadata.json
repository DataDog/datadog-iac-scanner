{
  "id": "80908a75-586b-4c61-ab04-490f4f4525b8",
  "queryName": "ELB without secure protocol",
  "severity": "MEDIUM",
  "category": "Encryption",
  "descriptionText": "Listeners on Classic Elastic Load Balancers must use encrypted protocols to protect data in transit. Listeners configured with plaintext protocols (for example, `HTTP` or `TCP`) can expose sensitive information and allow interception or tampering.\n \n For `AWS::ElasticLoadBalancing::LoadBalancer` resources, this rule checks each entry in `Properties.Listeners` and requires the `Protocol` and `InstanceProtocol` fields (when present) to be set to `SSL` or `HTTPS`. Resources missing these properties or with `Protocol`/`InstanceProtocol` set to values like `HTTP` or `TCP` will be flagged as insecure. \n \n Secure listener example (CloudFormation YAML):\n\n```yaml\nMyLoadBalancer:\n  Type: AWS::ElasticLoadBalancing::LoadBalancer\n  Properties:\n    Listeners:\n      - Protocol: HTTPS\n        LoadBalancerPort: 443\n        InstanceProtocol: HTTPS\n        InstancePort: 8443\n        SSLCertificateId: arn:aws:iam::123456789012:server-certificate/my-cert\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws/elb_without_secure_protocol",
  "platform": "CloudFormation",
  "descriptionID": "0cbd1ac7",
  "cloudProvider": "aws",
  "cwe": "319",
  "oldSeverity": "HIGH",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-elb.html"
}