{
  "id": "9b6a3f5b-5fd6-40ee-9bc0-ed604911212d",
  "queryName": "SQS policy with public access",
  "severity": "MEDIUM",
  "category": "Access Control",
  "descriptionText": "Allowing sensitive SQS management actions to wildcard principals lets any actor modify, delete, or change permissions on queues. This can enable resource takeover, data loss, or privilege escalation.\n\nThis rule inspects `AWS::SQS::QueuePolicy` resources and flags `PolicyDocument.Statement` entries where `Effect: \"Allow\"` and `Action` contains any of `SQS:AddPermission`, `SQS:CreateQueue`, `SQS:DeleteQueue`, `SQS:RemovePermission`, `SQS:TagQueue`, or `SQS:UnTagQueue`, if the `Principal` includes a wildcard (for example, `*` or patterns like `arn:aws:iam::*`). Statements that include a restrictive `Condition` are excluded from this flag. \n\nTo remediate, specify explicit principals (account ARNs or role ARNs) or add tight conditions (for example, `aws:SourceAccount`) to limit who can perform these actions.\n\nSecure configuration example with an explicit principal:\n\n```yaml\nMyQueuePolicy:\n  Type: AWS::SQS::QueuePolicy\n  Properties:\n    PolicyDocument:\n      Version: '2012-10-17'\n      Statement:\n        - Sid: AllowSpecificAccountManageQueue\n          Effect: Allow\n          Principal:\n            AWS: arn:aws:iam::123456789012:root\n          Action:\n            - SQS:RemovePermission\n            - SQS:TagQueue\n          Resource: arn:aws:sqs:us-east-1:123456789012:my-queue\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws/sqs_policy_with_public_access",
  "platform": "CloudFormation",
  "descriptionID": "a232933e",
  "cloudProvider": "aws",
  "cwe": "284",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-policy.html"
}
