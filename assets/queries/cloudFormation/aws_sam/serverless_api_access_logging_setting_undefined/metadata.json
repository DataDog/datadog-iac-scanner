{
  "id": "0a994e04-c6dc-471d-817e-d37451d18a3b",
  "queryName": "Serverless API access logging setting undefined",
  "severity": "MEDIUM",
  "category": "Observability",
  "descriptionText": "Serverless APIs should have access logging enabled to create an audit trail and support incident investigation and detection of anomalous or abusive traffic. For `AWS::Serverless::Api` resources, the `Properties.AccessLogSetting` property must be defined and not `null`. For `AWS::Serverless::HttpApi` resources, the `Properties.AccessLogSettings` property must be defined and not `null`. These properties configure the log destination and format, so missing or `null` values will be flagged. Ensure the access log configuration includes a log destination (for example, `DestinationArn`) and a `Format` describing the fields to record.\n\nSecure configuration examples:\n\n```yaml\nMyServerlessApi:\n  Type: AWS::Serverless::Api\n  Properties:\n    StageName: prod\n    AccessLogSetting:\n      DestinationArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/apigateway/my-api-logs\n      Format: '$context.identity.sourceIp - $context.requestId - $context.httpMethod $context.path'\n```\n\n```yaml\nMyHttpApi:\n  Type: AWS::Serverless::HttpApi\n  Properties:\n    AccessLogSettings:\n      DestinationArn: arn:aws:logs:us-east-1:123456789012:log-group:/aws/apigateway/my-httpapi-logs\n      Format: '{\"requestId\":\"$context.requestId\",\"ip\":\"$context.identity.sourceIp\",\"method\":\"$context.httpMethod\",\"path\":\"$context.path\"}'\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudformation/aws_sam/serverless_api_access_logging_setting_undefined",
  "platform": "CloudFormation",
  "descriptionID": "b2bb4961",
  "cloudProvider": "aws",
  "cwe": "778",
  "providerUrl": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-apigateway-stage-accesslogsetting.html"
}