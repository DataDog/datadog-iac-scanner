{
  "id": "cb2f612b-ed42-4ff5-9fb9-255c73d39a18",
  "queryName": "Serverless function without dead-letter queue",
  "severity": "LOW",
  "category": "Insecure Configurations",
  "descriptionText": "Serverless functions without a dead-letter queue (DLQ) can lose events from failed asynchronous invocations and make failure diagnosis and recovery difficult. For `AWS::Serverless::Function` resources, the `DeadLetterConfig` property must be defined and not `null`. The `DeadLetterConfig` should include a valid `TargetArn` that points to a durable target such as an Amazon SQS queue or an Amazon SNS topic; resources missing `DeadLetterConfig` or with it set to `null` will be flagged.\n\nSecure configuration example:\n\n```yaml\nMyDeadLetterQueue:\n  Type: AWS::SQS::Queue\n\nMyFunction:\n  Type: AWS::Serverless::Function\n  Properties:\n    Handler: index.handler\n    Runtime: nodejs14.x\n    DeadLetterConfig:\n      TargetArn: !GetAtt MyDeadLetterQueue.Arn\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/cloudFormation/aws_sam/serverless_function_without_dead_letter_queue",
  "platform": "CloudFormation",
  "descriptionID": "1142bb9f",
  "cloudProvider": "aws",
  "cwe": "390",
  "providerUrl": "https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-resource-function.html#sam-function-deadletterqueue"
}
