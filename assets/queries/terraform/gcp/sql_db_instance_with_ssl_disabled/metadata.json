{
  "id": "02474449-71aa-40a1-87ae-e14497747b00",
  "queryName": "SQL DB instance with SSL disabled",
  "severity": "HIGH",
  "category": "Encryption",
  "descriptionText": "Google Cloud SQL instances without SSL enabled allow unencrypted connections, which can lead to data exposure through network eavesdropping and man-in-the-middle attacks. SSL encryption provides an essential layer of security for database connections by encrypting data in transit between the client and server. To secure your Google Cloud SQL Database, you should set `ssl_mode` to `ENCRYPTED_ONLY` or `TRUSTED_CLIENT_CERTIFICATE_REQUIRED` in the `ip_configuration` block (recommended), or set the legacy `require_ssl = true`:\n\n```\nsettings {\n  ip_configuration {\n    ssl_mode = \"ENCRYPTED_ONLY\"\n  }\n}\n```\n\nThe `ssl_mode` attribute replaces the legacy `require_ssl` and provides more granular control: `ENCRYPTED_ONLY` enforces encryption for all connections, while `TRUSTED_CLIENT_CERTIFICATE_REQUIRED` additionally requires valid client certificates. Without this configuration, sensitive data such as credentials, personal information, and proprietary data could be intercepted when transmitted over the network.",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/terraform/gcp/sql_db_instance_with_ssl_disabled",
  "platform": "Terraform",
  "descriptionID": "8983549e",
  "cloudProvider": "gcp",
  "cwe": "732",
  "oldDescriptionText": "Cloud SQL Database Instance should have SSL enabled",
  "providerUrl": "https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance#require_ssl"
}