{
  "id": "0008c003-79aa-42d8-95b8-1c2fe37dbfe6",
  "queryName": "Multiple RUN, ADD, COPY instructions listed",
  "severity": "LOW",
  "category": "Best Practices",
  "descriptionText": "Dockerfiles that use multiple consecutive `RUN`, `COPY`, or `ADD` instructions create extra image layers, which increases image size and can preserve intermediate artifacts (including secrets), raising the risk of sensitive data exposure and making images harder to scan.\n\nThis rule inspects Dockerfile instructions and flags adjacent `RUN` instructions or adjacent `COPY`/`ADD` instructions that target the same destination (the last argument) because these can be consolidated into single instructions to avoid extra layers. Group shell commands with `&&` into one `RUN`, and combine multiple sources into a single `COPY`/`ADD` that lists all source paths with one destination.\n\nSecure examples:\n\n```dockerfile\n# Combine RUN commands\nRUN apt-get update && apt-get install -y curl ca-certificates && rm -rf /var/lib/apt/lists/*\n\n# Combine COPY sources to a single destination\nCOPY config/app.conf config/db.conf /app/config/\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/dockerfile/multiple_run_add_copy_instructions_listed",
  "platform": "Dockerfile",
  "descriptionID": "29bd3a34",
  "cwe": "710",
  "providerUrl": "https://sysdig.com/blog/dockerfile-best-practices/"
}