{
  "id": "e36d8880-3f78-4546-b9a1-12f0745ca0d5",
  "queryName": "npm install command without pinned version",
  "severity": "MEDIUM",
  "category": "Supply-Chain",
  "descriptionText": "Installing packages without pinned versions risks unintentional or malicious dependency upgrades, leading to supply-chain compromises, newly introduced vulnerabilities, or non-reproducible builds.\n\nThis rule inspects `run` command entries that invoke `npm install`, `npm i`, or `npm add` and requires each package argument (excluding command flags) to include an explicit version or tag (for example, `package@1.2.3` or `@scope/pkg@^1.2.3`) or be a git-based reference (for example, `git+https://...`). Tokens that start with `-` (npm flags) are allowed. Scoped packages must still include a version suffix and bare package names without an `@version` will be flagged. \n\nSecure example with pinned versions:\n\n```json\n{\n  \"scripts\": {\n    \"install-deps\": \"npm install express@4.17.1 lodash@4.17.21 @scope/pkg@1.2.3\"\n  }\n}\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/dockerfile/npm_install_without_pinned_version",
  "platform": "Dockerfile",
  "descriptionID": "8bd60033",
  "cwe": "1357",
  "providerUrl": "https://docs.docker.com/engine/reference/builder/#run"
}