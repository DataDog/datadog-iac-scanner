{
  "id": "93d88cf7-f078-46a8-8ddc-178e03aeacf1",
  "queryName": "Missing version specification in dnf install",
  "severity": "MEDIUM",
  "category": "Supply-Chain",
  "descriptionText": "Dockerfile `RUN` commands that install packages with DNF must pin package versions to ensure reproducible builds and avoid unintended upgrades or supply-chain changes that can introduce vulnerable or incompatible packages.\n\nThis rule scans Dockerfile `RUN` instructions invoking `dnf install` and flags package operands that do not include an explicit version suffix. Packages should be specified with a concrete version (for example, `package-1.2.3` or `package-1.2.3-1`).\n\nResources with unversioned package names in the `RUN` line will be flagged. Fix by pinning versions in the install command or by using a locked repository snapshot or package manifest for reproducible, auditable builds.\n\nSecure example:\n\n```dockerfile\nRUN dnf -y install openssl-1.1.1k-1.el8 curl-7.61.1-12.el8 && dnf clean all\n```",
  "descriptionUrl": "https://docs.datadoghq.com/security/code_security/iac_security/iac_rules/dockerfile/missing_version_specification_in_dnf_install",
  "platform": "Dockerfile",
  "descriptionID": "0ab4ed7e",
  "cwe": "1357",
  "providerUrl": "https://docs.docker.com/develop/develop-images/dockerfile_best-practices/"
}